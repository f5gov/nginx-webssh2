# SSL/TLS Parameters with FIPS 140-2 Compliance
# This file contains static SSL configuration that doesn't require templating

# FIPS 140-2 approved protocols only
ssl_protocols TLSv1.2 TLSv1.3;

# FIPS 140-2 approved cipher suites (will be overridden by env var if set)
# These are the default FIPS-compliant ciphers
ssl_ciphers ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-GCM-SHA256;

# Server cipher preference
ssl_prefer_server_ciphers on;

# FIPS-approved elliptic curves
# In FIPS mode, let OpenSSL choose appropriate curves
# ssl_ecdh_curve secp384r1:secp256r1;

# SSL session settings
ssl_session_timeout 1d;
ssl_session_cache shared:SSL:50m;
ssl_session_tickets off;

# OCSP stapling (disabled for self-signed certificates)
# Note: These lines will be uncommented by init script for non-self-signed certificates
# ssl_stapling on;
# ssl_stapling_verify on;
# resolver 8.8.8.8 8.8.4.4 valid=300s;
# resolver_timeout 5s;

# Security headers for SSL
add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload" always;
add_header X-Content-Type-Options "nosniff" always;
add_header X-Frame-Options "SAMEORIGIN" always;
add_header Referrer-Policy "strict-origin-when-cross-origin" always;

# Perfect Forward Secrecy (PFS) with FIPS-approved parameters
# DH parameters will be generated at runtime if needed
# ssl_dhparam /etc/nginx/certs/dhparam.pem;